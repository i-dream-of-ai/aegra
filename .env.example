# --- Application Settings ---
PROJECT_NAME=Aegra
VERSION="0.1.0"
DEBUG=true

# [MANDATORY] Path to the main agent configuration file
AEGRA_CONFIG=

# Database (LangGraph state storage)
POSTGRES_USER=user
POSTGRES_PASSWORD=password
POSTGRES_DB=aegra
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/aegra
DATABASE_ECHO=false

# --- Connection Pools ---
# SQLAlchemy (Metadata & App)
SQLALCHEMY_POOL_SIZE=2
SQLALCHEMY_MAX_OVERFLOW=0

# LangGraph (Agent Runtime)
LANGGRAPH_MIN_POOL_SIZE=1
LANGGRAPH_MAX_POOL_SIZE=6

# Authentication (extensible)
AUTH_TYPE=custom  # custom (default, secure), noop (dev only)

# Server Configuration
HOST=0.0.0.0
PORT=8000
DEBUG=true
SERVER_URL=http://localhost:8000

# Logging
LOG_LEVEL=INFO
ENV_MODE=LOCAL # DEVELOPMENT, PRODUCTION, LOCAL (PRODUCTION outputs JSON logs)
LOG_VERBOSITY=standard # standard, verbose (verbose outputs request-id for each request)

# LLM Providers
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-...

# --- Observability (Langfuse) ---
LANGFUSE_LOGGING=false
LANGFUSE_SECRET_KEY=sk-...
LANGFUSE_PUBLIC_KEY=pk-...
LANGFUSE_HOST=https://cloud.langfuse.com

# ======================================
# CRITICAL: Main App Communication
# ======================================
# These are REQUIRED for aegra to fetch user QC credentials from Next.js app

# Production URL of the Next.js app (Vercel)
MAIN_APP_URL=https://your-app.vercel.app

# Shared secret - must match LEAN_API_SECRET in Next.js app
LEAN_API_SECRET=your-random-secret-here

# ======================================
# QuantConnect
# ======================================
# Organization ID (used for creating projects in user's org)
QUANTCONNECT_ORGANIZATION_ID=...

# NOTE: User ID and Token are NO LONGER stored here!
# Users provide their own credentials in Settings -> API Keys
# Aegra fetches them via MAIN_APP_URL/api/internal/user-credentials

# ======================================
# Built-in Engine / lean-api (Optional)
# ======================================
# Only needed if running the built-in LEAN engine

# Supabase connection for lean-api
SUPABASE_URL=https://...
SUPABASE_SERVICE_ROLE_KEY=...

# Market data provider
ALPHA_VANTAGE_API_KEY=...

# Internal auth for lean-api
INTERNAL_SERVICE_SECRET=your-random-secret-here

# LEAN Data Cache (s3fs mount for built-in engine)
# On the host, mount a DO Space at /opt/lean-data-cache using s3fs:
# s3fs lean-cache-data /opt/lean-data-cache -o passwd_file=/etc/passwd-s3fs,url=https://sfo3.digitaloceanspaces.com,use_path_request_style,allow_other
